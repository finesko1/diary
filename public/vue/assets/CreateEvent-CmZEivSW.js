import{h as Y,k as f,r as g,c as a,o as d,a as e,b as p,m as Z,u as I,e as z,x as y,y as m,t as u,F as _,d as C,q as ee,v as U,n as j,z as te}from "./index-B3aGkqQj.js";const se={class:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900/50 backdrop-blur-sm p-2 sm:p-4"},oe={class:"flex flex-col w-full max-w-4xl max-h-[95vh] bg-white rounded-2xl shadow-2xl overflow-hidden"},le={class:"flex items-center justify-between p-6 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-white sticky top-0 z-20"},ne={class:"flex-1 overflow-y-auto p-4 sm:p-6 scrollbar-light scrollbar-primary"},re={class:"space-y-6"},ae={class:"bg-gray-50 rounded-xl p-4 sm:p-6 space-y-6"},de={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ie={class:"space-y-3"},ce={class:"border border-gray-200 rounded-xl overflow-hidden"},ue={class:"flex items-center justify-between p-4 sm:p-6 bg-gradient-to-r from-blue-50 to-gray-50 border-b border-gray-200 sticky top-16 z-10"},pe={class:"flex items-center gap-4"},ve={class:"flex items-center gap-4 mt-1"},be={class:"text-secondary"},ge={class:"text-secondary"},ye={class:"p-8 my-6 sm:p-6 space-y-6 mt-12 overflow-y-auto"},me={class:"flex-col items-center justify-between border-gray-400"},xe={class:"flex w-full bg-gray-50 p-2 sm:p-4 rounded-md"},fe={class:"flex items-center gap-4 flex-1"},he=["onClick"],ke={class:"flex-1"},we=["onUpdate:modelValue","onInput"],_e={class:"flex items-center space-x-2 pl-2"},Ce=["onClick"],je=["onClick"],Me={class:"flex justify-end items-center gap-4 mt-2"},Ve={class:"text-secondary"},$e={key:0,class:"p-4 sm:p-6 space-y-6"},Be={class:"space-y-3"},Te=["onUpdate:modelValue"],ze={class:"space-y-4"},Ue={class:"flex items-center justify-between"},Ae={class:"text-secondary"},Se={class:"space-y-4"},De={class:"flex items-center justify-between mb-4"},Le=["onClick"],Ne={class:"p-1 text-gray-500 hover:text-gray-700 transition-colors cursor-pointer"},Ee={class:"font-medium text-gray-700"},Fe={key:0,class:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full"},He={class:"flex items-center gap-2"},Ke=["onClick"],Oe={key:0,class:"space-y-4 pl-8"},qe={class:"space-y-3"},Re={class:"relative"},Ge={class:"flex gap-2"},Je=["onUpdate:modelValue","onClick","onBlur","onKeyup"],Pe={key:0,class:"absolute z-20 w-full mt-2 bg-white border border-gray-300 rounded-xl shadow-2xl overflow-hidden"},Qe={class:"max-h-64 scrollbar-primary"},We=["onMousedown"],Xe={class:"flex items-center gap-2"},Ye=["onMousedown"],Ze={class:"space-y-3"},Ie=["onUpdate:modelValue"],et={class:"space-y-3"},tt={class:"flex justify-between items-center"},st=["onClick"],ot={class:"flex flex-wrap gap-2 p-2"},lt={key:0,class:"p-12 bg-gray-300/50 rounded-md"},nt={class:"border-b border-dotted pb-4"},rt=["onClick"],at={key:0,class:"text-center mt-12"},dt={class:"bg-white rounded-xl shadow-2xl p-6 min-w-96 max-w-md mx-4"},it={class:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-2"},ct={class:"text-center"},ut={class:"text-info"},pt={class:"flex gap-3 justify-end"},vt={class:"flex items-center justify-between p-6 border-t border-gray-100 bg-gray-50 sticky bottom-0 z-10"},bt={class:"flex items-center gap-4"},gt={class:"text-secondary"},xt={__name:"CreateEvent",props:{},setup(yt){const M=Y(),A=I(),h=f(()=>M.isAdmin||M.isTeacher?{date:new Date().toISOString().split("T")[0],events:{}}:null),n=g([]),V=()=>{n.value.push({label:`Тема ${n.value.length+1}`,description:"",expanded:!0,tasks:[]})},S= s=>{n.value[s].expanded=!n.value[s].expanded},D=(s, t)=>{n.value[s].label=t.target.value},L= s=>{confirm("Удалить тему и все задания?")&&n.value.splice(s,1)},$= s=>{n.value[s].tasks.push({description:"",category:"",expanded:!0})},N=(s, t)=>{n.value[s].tasks[t].expanded=!n.value[s].tasks[t].expanded},E=(s, t)=>{n.value[s].tasks.splice(t,1)},F=(s, t)=>{console.log("Add documents for task",s,t)},k=f(()=>n.value.reduce((s, t)=>s+t.tasks.length,0)),H=["Чтение","Диктант","Грамматика","Словарь","Аудирование","Письмо","Говорение","Перевод","Тест","Проект","Презентация","Дискуссия"],K=g([]),w=f(()=>[...H,...K.value]),v=g(""),O=f(()=>v.value?w.value.filter(s=>s.toLowerCase().includes(v.value.toLowerCase())):w.value),q=(s, t)=>b.value.topicIndex===s&&b.value.taskIndex===t,b=g({topicIndex:null,taskIndex:null}),R=(s, t, l, r=!1)=>{v.value="",n.value[s].tasks[t].category=l,b.value={topicIndex:null,taskIndex:null}},B=async(s, t)=>{var c;const r=(c=n.value[s].tasks[t].category)==null?void 0:c.trim(),o=G(r);x.value=!o&&r.length>0,b.value={topicIndex:null,taskIndex:null}},x=g(!1),G= s=>w.value.includes(s),J= s=>{v.value=s.target.value},P= s=>{console.log("Удаление категории ",s)},Q=()=>{const s={date:h.value.date,topics:n.value.map(t=>({title:t.label,description:t.description,tasks:t.tasks.map(l=>({type:l.category,description:l.description}))})),totalTasks:k.value};console.log("Saving activity:",s)};return(s, t)=>(d(),a("div",se,[e("div",oe,[e("div",le,[t[8]||(t[8]=e("div",null,[e("h1",{class:"header-1"},"Новое занятие"),e("p",{class:"text-secondary mt-1"},"Заполните информацию о занятии")],-1)),e("button",{onClick:t[0]||(t[0]= l=>Z(A).back()),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors duration-200 cursor-pointer","aria-label":"Закрыть"},[...t[7]||(t[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ne,[e("div",re,[e("div",ae,[t[11]||(t[11]=e("h3",{class:"header-2"},"Основная информация",-1)),e("div",de,[e("div",ie,[t[9]||(t[9]=e("label",{class:"block text-primary"},"Дата занятия",-1)),y(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]= l=>h.value.date=l),class:"w-full px-4 py-3 text-lg border border-gray-300 rounded-xl focus:ring-3 focus:ring-blue-500 focus:border-blue-500 transition-colors"},null,512),[[m,h.value.date]])]),t[10]||(t[10]=z('<div class="space-y-3"><label class="block text-primary">Обучающийся</label><div class="px-4 py-3 bg-white border border-gray-300 rounded-xl"><div class="flex items-center"><div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4"><span class="text-blue-600 font-bold text-lg">ИИ</span></div><div><span class="font-semibold text-gray-800 text-lg">Иван Иванов</span><p class="text-secondary">Ученик 8 класса</p></div></div></div></div>',1))]),t[12]||(t[12]=z('<div class="space-y-3"><label class="block text-primary">Предмет</label><div class="px-4 py-3 bg-white border border-gray-300 rounded-xl"><div class="flex items-center"><div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-4"><span class="text-green-600 font-bold text-lg">АЯ</span></div><div><span class="font-semibold text-gray-800 text-lg">Английский язык</span><p class="text-secondary">Уровень: Intermediate</p></div></div></div></div>',1))]),e("div",ce,[e("div",ue,[e("div",pe,[e("div",null,[t[13]||(t[13]=e("h2",{class:"header-2"},"Темы занятия",-1)),e("div",ve,[e("span",be,"Тем: "+u(n.value.length),1),e("span",ge,"Заданий: "+u(k.value),1)])])]),e("button",{onClick:V,class:"flex items-center gap-2 add-button"}," Добавить тему ")]),e("div",ye,[(d(!0),a(_,null,C(n.value,(l, r)=>(d(),a("div",{key:r,class:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm p-8"},[e("div",me,[e("div",xe,[e("div",fe,[e("button",{onClick: o=>S(r),class:j(["p-3 dropdown-button",{"dropdown-button-expanded":l.expanded}]),title:"Показать содержимое"},[(d(),a("svg",{class:j(["w-5 h-5 transition-transform duration-300",{"rotate-90":l.expanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[14]||(t[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))],10,he),e("div",ke,[y(e("input",{onClick:t[2]||(t[2]= o=>o.target.select()),type:"text","onUpdate:modelValue": o=>l.label=o,placeholder:"Название темы...",class:"w-full text-lg font-semibold input-primary",onInput: o=>D(r,o)},null,40,we),[[m,l.label]])])]),e("div",_e,[e("button",{onClick: o=>$(r),class:"p-3 add-button",title:"Добавить задание"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,Ce),e("button",{onClick: o=>L(r),class:"p-3 del-button",title:"Удалить тему"},[...t[16]||(t[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,je)])]),e("div",Me,[e("span",Ve,u(l.tasks.length)+" заданий",1)])]),l.expanded?(d(),a("div",$e,[e("div",Be,[t[17]||(t[17]=e("label",{class:"block text-lg font-semibold text-gray-800"},"Описание темы",-1)),y(e("textarea",{"onUpdate:modelValue": o=>l.description=o,rows:"4",placeholder:"Детальное описание темы, цели и задачи...",class:"w-full px-4 py-3 textarea-primary scrollbar-primary resize-none"},null,8,Te),[[m,l.description]])]),e("div",ze,[e("div",Ue,[t[18]||(t[18]=e("h2",{class:"header-2"},"Задания",-1)),e("span",Ae,u(l.tasks.length),1)]),e("div",Se,[(d(!0),a(_,null,C(l.tasks,(o, c)=>{var T;return d(),a("div",{key:c,class:"bg-gray-50 rounded-xl p-4 border border-gray-200"},[e("div",De,[e("div",{onClick: i=>N(r,c),class:"flex w-full items-center gap-3 cursor-pointer"},[e("button",Ne,[(d(),a("svg",{class:j(["w-5 h-5 transition-transform duration-300",{"rotate-90":o.expanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2))]),e("span",Ee," Задание "+u(c+1),1),o.category?(d(),a("span",Fe,u(o.category),1)):p("",!0)],8,Le),e("div",He,[e("button",{onClick: i=>E(r,c),class:"p-2 del-button",title:"Удалить задание"},[...t[20]||(t[20]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ke)])]),o.expanded?(d(),a("div",Oe,[e("div",qe,[t[22]||(t[22]=e("label",{class:"block text-primary"},"Вид задания",-1)),e("div",Re,[e("div",Ge,[y(e("input",{"onUpdate:modelValue": i=>o.category=i,onClick: i=>{b.value={topicIndex:r,taskIndex:c},v.value=o.category},onInput:t[3]||(t[3]= i=>J(i)),onBlur: i=>B(r,c),onKeyup:te(i=>B(r,c),["enter"]),placeholder:"Поиск типа задания...",class:"w-full input-primary"},null,40,Je),[[m,o.category]])]),q(r,c)?(d(),a("div",Pe,[e("div",Qe,[(d(!0),a(_,null,C(O.value,(i, W)=>(d(),a("div",{key:W,onMousedown: X=>R(r,c,i,!1),class:"px-4 py-3 hover:bg-gray-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0 flex items-center justify-between"},[e("span",null,u(i),1),e("div",Xe,[e("button",{onMousedown: X=>P(i),class:"p-2 del-button",title:"Удалить категорию"},[...t[21]||(t[21]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],40,Ye)])],40,We))),128))])])):p("",!0)])]),e("div",Ze,[t[23]||(t[23]=e("label",{class:"block text-primary"},"Описание задания",-1)),y(e("textarea",{"onUpdate:modelValue": i=>o.description=i,rows:"4",placeholder:"Описание...",class:"w-full px-4 py-3 text-lg input-primary resize-none"},null,8,Ie),[[m,o.description]])]),e("div",et,[e("div",tt,[t[25]||(t[25]=e("label",{class:"block text-primary"},"Вложения",-1)),e("button",{onClick: i=>F(r,c),class:"p-2 add-button",title:"Добавить файлы"},[...t[24]||(t[24]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])],8,st)]),e("div",ot,[((T=o==null?void 0:o.attachments)==null?void 0:T.length)>0?(d(),a("div",lt," фото ")):p("",!0)])])])):p("",!0)])}),128))]),e("div",nt,[e("button",{onClick: o=>$(r),class:"w-full add-button"}," Добавить задание ",8,rt)])])])):p("",!0)]))),128)),n.value.length===0?(d(),a("div",at,[...t[26]||(t[26]=[e("div",{class:"w-24 h-24 mx-auto mb-2 text-gray-300"},[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("p",{class:"text-gray-500"},"Начните с добавления первой темы для занятия",-1)])])):p("",!0),n.value.length>1?(d(),a("button",{key:1,onClick:V,class:"flex w-full justify-center items-center gap-2 add-button"}," Добавить тему ")):p("",!0)])])])]),x.value?(d(),a("div",{key:0,class:"fixed flex items-center justify-center z-50 bg-gray-900/50 inset-0",onClick:t[6]||(t[6]=ee(l=>x.value=!1,["self"]))},[e("div",dt,[t[29]||(t[29]=e("div",{class:"text-center mb-4"},[e("h3",{class:"header-3"},"Новая категория")],-1)),e("div",it,[e("p",ct,[t[27]||(t[27]=U(" Добавить категорию ",-1)),e("span",ut,u(v.value),1),t[28]||(t[28]=U(" в список? ",-1))])]),e("div",pt,[e("button",{onClick:t[4]||(t[4]= l=>x.value=!1),class:"del-button max-w-min h-min"}," Отмена "),e("button",{onClick:t[5]||(t[5]= l=>console.log("добавить категорию")),class:"add-button h-min"}," Добавить ")])])])):p("",!0),e("div",vt,[e("div",bt,[e("div",gt,u(n.value.length)+" тем "+u(k.value)+" заданий ",1)]),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:Q,class:"px-8 add-button"}," Создать занятие ")])])])]))}};export{xt as default};
